<!DOCTYPE html>
<html>
  <head>
    <script type="text/javascript" src="/homey.js" data-origin="settings"></script>
  </head>

  <body>
    <header class="homey-header">
      <h1 class="homey-title">Remote url</h1>
    </header>

    <p>
      If you are connected to the same network as your Homey, and opened this configuration page using the Homey iOS or Android app, 
      the following link will not be remote. To get the true remote url, use https://my.homey.app or disconnect temporary from the network.
    </p>

    <button onclick="openRemote()" class="homey-button-primary">Open remote URL</button>

    <header class="homey-header">
      <h1 class="homey-title">Local url</h1>
    </header>

    <p>
      The following url is the dashboard local url for your Homey. This should only work on your local network.
    </p>

    <button onclick="openLocal()" class="homey-button-primary">Open local URL</button>

    <script type="text/javascript">
      let localUrl;
      let remoteUrl;
      let homey;

      function onHomeyReady(Homey) {
        // Retain the Homey instance for later use.
        homey = Homey;

        const urlPostfix = '/app/skogsaas.dashboards/assets/dashboard';
        remoteUrl = location.origin + urlPostfix;
      
        homey.get("homey_id", function (err, homeyId) {
          localUrl = 'http://homey-' + homeyId + '.local' + urlPostfix;
        });

        homey.ready();
      }

      function openRemote() {
        homey.api('GET', '/auth/code', null, (error, response) => homey.openURL(remoteUrl + '?code=' + response));
      }

      function openLocal() {
        homey.api('GET', '/auth/code', null, (error, response) => homey.openURL(localUrl + '?code=' + response));
      }
    </script>
    
  </body>
</html>